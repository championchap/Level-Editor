const React = require('react')
const { connect } = require('react-redux')

const style = require('./terrain-editor.sass')

const {
  game,
  graphics,
  mouse,
  prevMouse,
  keyboard,
  assets,
  sound,
  grid
} = require('@erikwatson/bramble')

const Layout = require('../layouts/sidebar-left/sidebar-left.js')
const Sidebar = require('./sidebar/sidebar.js')
const BrambleView = require('../../components/ui/bramble-view/bramble-view.js')

// prettier-ignore
const allShapes = [
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,1,0,0,0,1,0,0,0,1,1,0,0,1,0,0,1,1,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0],
  [0,0,1,0,0,1,1,1,0,1,1,1,0,0,1,1,0,1,1,1,0],
  [0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,1,0,0,0,1,0,0,1,1,0,0,0,1,1,0,1,1,0,0],
  [0,1,1,0,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,0,0],
  [0,0,1,0,0,0,1,0,0,0,1,1,0,1,1,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0],
  [0,0,1,1,0,0,1,1,0,1,1,0,0,1,1,0,0,0,1,1,0],
  [0,0,0,0,0,0,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,0,0,1,1,0],
  [0,0,1,1,0,1,1,0,0,1,1,1,0,1,1,1,0,1,1,1,0],
  [0,0,1,0,0,0,1,0,0,1,1,0,0,0,1,0,0,0,1,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,1,0,0,1,1,1,0,0,1,1,0,0,0,0,0,1,1,0,0],
  [0,1,1,1,0,1,1,1,0,0,1,1,0,1,1,1,0,1,1,0,0],
  [0,0,1,1,0,0,0,0,0,0,1,1,0,1,1,1,0,1,1,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,1,1,0,0,1,0,0,0,0,0,0,1,1,0,0,0,1,0,0],
  [0,1,1,1,0,0,1,1,0,1,1,1,0,1,1,0,0,1,1,0,0],
  [0,0,0,0,0,0,1,1,0,1,1,0,0,0,1,0,0,1,1,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,1,1,0,0,0,1,1,0,0,0,0,0,0,1,0,0,1,1,0,0],
  [0,1,1,1,0,0,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0],
  [0,0,0,0,0,0,1,0,0,0,1,1,0,1,1,1,0,1,1,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,1,1,1,0,0,1,1,0,0,1,1,0,1,1,0,0,1,1,1,0],
  [0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0],
  [0,0,1,0,0,0,1,1,0,1,1,1,0,1,1,1,0,1,1,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,1,1,1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,1,1,1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,1,1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],
  [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
]

class TerrainEditor extends React.Component {
  render() {
    const brambleUpdate = delta => {}

    const brambleRender = () => {
      graphics.clear('#000000')
      graphics.tiles(
        0, // camera x
        0, // camera y
        allShapes, // tiles, the array
        this.props.spritesheets, // spritesheets, an array of spritesheets
        4, // scale
        8, // tileSize
        8 // tileSize
      )
    }

    return (
      <Layout>
        <Sidebar />
        <BrambleView update={brambleUpdate} render={brambleRender} />
      </Layout>
    )
  }
}

const mapStateToProps = state => {
  return {
    spritesheets: state.spritesheets
  }
}

module.exports = connect(mapStateToProps)(TerrainEditor)
